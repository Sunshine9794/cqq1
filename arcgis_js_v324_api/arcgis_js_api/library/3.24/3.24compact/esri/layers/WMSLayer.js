// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.24/esri/copyright.txt for details.
//>>built
require({cache:{"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(n,h,m,t,d,a,w,q){n=n([a,w],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(a,e){h.mixin(this,e);this.initialize(a,e)},getTitle:function(a){var e;this.info&&(e=this.titleHasRelatedFields?"":this._getPopupValues(a,null,!0).title);return e||
""},getContent:function(a){return this.info?(new q({template:this,graphic:a,chartTheme:this.chartTheme},t.create("div"))).domNode:""}});m("extend-esri")&&h.setObject("dijit.PopupTemplate",n,d);return n})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all dojox/html/entities ./lang ./kernel ./request ./promiseList ./tasks/query ./tasks/QueryTask ./tasks/RelationshipQuery ./tasks/StatisticDefinition ./support/expressionUtils ./layers/support/attributeUtils dojo/i18n!dojo/cldr/nls/number".split(" "),
function(n,h,m,t,d,a,w,q,v,e,k,C,B,z,A,D,E,c,l,r,x){n=n(null,{declaredClass:"esri.PopupInfo",_reExprField:/^\s*expression\//i,_exprPrefix:"expression/",_relatedFieldPrefix:"relationships/",initialize:function(b,f){if(b){h.mixin(this,f);this.info=b;this.title=this.getTitle;this.content=this.getContent;this._exprCache=this._compileExpressions(this.info.expressionInfos);var c=this._fieldLabels={},u=this._fieldsMap={};this.info.fieldInfos&&m.forEach(this.info.fieldInfos,function(p){var g=p.fieldName.toLowerCase(),
b=this._isExpressionField(g)?this.getExpressionInfo(g):null;c[g]=b?b.title:p.label;u[g]=p},this);this.titleHasRelatedFields=!(!this.info.title||-1===this.info.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return t.fromJson(t.toJson(this.info))},getTitle:function(){},getContent:function(){},getFieldInfo:function(b){var f;m.some(this.info&&this.info.fieldInfos,function(c){c.fieldName===b&&(f=c);return!!f});return f},getExpressionInfo:function(b){if(this._isExpressionField(b)){b=b.replace(this._reExprField,
"");b=b.toLowerCase();var f;m.some(this.info.expressionInfos,function(c){c.name.toLowerCase()===b&&(f=c);return!!f});return f}},hasGeometryOperations:function(){return m.some(this.info.expressionInfos,function(b){return l.hasGeometryOperations(b.expression)})},getComponents:function(b){var f=this.info,c={};f.fieldInfos&&(f=m.filter(f.fieldInfos,function(b){return-1!==b.fieldName.indexOf(this._relatedFieldPrefix)},this))&&0<f.length&&(c.relatedInfo=this._getRelatedRecords({graphic:b,fieldsInfo:f}));
this._needFullResolutionFeature(b)&&(c.fullResolutionFeature=this._getFullResolutionFeature(b));return z(c).then(h.hitch(this,function(f){return this._getPopupValues(b,f.fullResolutionFeature)}))},getAttachments:function(b){var f=b.getSourceLayer();b=b.attributes;if(this.info.showAttachments&&f&&f.hasAttachments&&f.objectIdField&&(b=b&&b[f.objectIdField]))return f.queryAttachmentInfos(b)},_needFullResolutionFeature:function(b){return(b=b.getSourceLayer())?"esriGeometryPoint"!==b.geometryType&&"function"===
typeof b.getMaxAllowableOffset&&0<b.getMaxAllowableOffset()&&this.hasGeometryOperations():!1},_getFullResolutionFeature:function(b){var f=b.getSourceLayer(),c=f.objectIdField;b=(b=b.attributes)&&c&&b[c];if(null==b)return null;var u=new A;u.objectIds=[b];u.maxAllowableOffset=0;u.outFields=[c];return f.queryFeatures(u).then(function(p){return p.features&&p.features[0]})},_isExpressionField:function(b){return this._reExprField.test(b)},_compileExpressions:function(b){var f={};m.forEach(b,function(b){var u=
b.returnType&&b.returnType.toLowerCase();f[b.name]=r.createAttributeCache({valueExpression:b.expression},"number"!==u)});return f},_fetchAttributes:function(b,f){var c=h.clone(b.attributes)||{},u=f&&f.geometry,p=this._exprPrefix,g=this._exprCache;m.forEach(this.info.expressionInfos,function(f){var y=p+f.name;f=(f=g[f.name])?b._getDataValue(f.attributeInfo,f,l,null,u):null;"string"===typeof f&&(f=e.encode(f));c[y]=f});return c},_getPopupValues:function(b,f,c){var u=this.info,p=b.getSourceLayer(),g=
this._fetchAttributes(b,f),y=h.clone(g);f=u.fieldInfos;var l="",a="",A,r,e,x,d,q=p&&p._getDateOpts&&p._getDateOpts().properties,q=q&&q.slice(0),B={dateFormat:{properties:q,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};if(this._relatedInfo)for(x in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(x)){var v=this._relatedInfo[x],w=this._relatedLayersInfo[x];v&&(m.forEach(v.relatedFeatures,function(p){for(d in p.attributes)if(p.attributes.hasOwnProperty(d)&&"esriRelCardinalityOneToOne"===
w.relation.cardinality){var b=this._toRelatedFieldName([w.relation.id,d]);g[b]=y[b]=p.attributes[d]}},this),m.forEach(v.relatedStatsFeatures,function(p){for(d in p.attributes)if(p.attributes.hasOwnProperty(d)){var b=this._toRelatedFieldName([w.relation.id,d]);g[b]=y[b]=p.attributes[d]}},this))}f&&m.forEach(f,function(g){r=g.fieldName;var b=this._getLayerFieldInfo(p,r);b&&(r=g.fieldName=b.name);y[r]=this._formatValue(y[r],r,B);q&&g.format&&g.format.dateFormat&&(g=m.indexOf(q,r),-1<g&&q.splice(g,1))},
this);if(p){x=p.types;var D=(v=p.typeIdField)&&g[v];for(r in g)if(g.hasOwnProperty(r)&&-1===r.indexOf(this._relatedFieldPrefix)&&(e=g[r],k.isDefined(e))){var n=this._getDomainName(p,b,x,D,r,e);k.isDefined(n)?y[r]=n:r===v&&(n=this._getTypeName(p,b,e),k.isDefined(n)&&(y[r]=n))}}u.title&&(l=this._processFieldsInLinks(this._fixTokens(u.title,p),g),l=h.trim(k.substitute(y,l,B)||""));if(c)return{title:l};u.description&&(a=this._processFieldsInLinks(this._fixTokens(u.description,p),g),a=h.trim(k.substitute(y,
a,B)||""));f&&(A=[],m.forEach(f,function(g){(r=g.fieldName)&&g.visible&&A.push([this._fieldLabels[r.toLowerCase()]||r,k.substitute(y,"${"+r+"}",B)||""])},this));var t,z;u.mediaInfos&&(t=[],m.forEach(u.mediaInfos,function(b){z=0;e=b.value;switch(b.type){case "image":var f=e.sourceURL,f=f&&h.trim(k.substitute(g,this._fixTokens(f,p)));z=!!f;break;case "piechart":case "linechart":case "columnchart":case "barchart":var u,f=e.normalizeField;e.fields=m.map(e.fields,function(g){return(u=this._getLayerFieldInfo(p,
g))?u.name:g},this);f&&(u=this._getLayerFieldInfo(p,f),e.normalizeField=u?u.name:f);z=m.some(e.fields,function(p){return k.isDefined(g[p])||-1!==p.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(z){b=h.clone(b);e=b.value;var f=b.title?this._processFieldsInLinks(this._fixTokens(b.title,p),g):"",c=b.caption?this._processFieldsInLinks(this._fixTokens(b.caption,p),g):"";b.title=f?h.trim(k.substitute(y,f,B)||""):"";b.caption=c?h.trim(k.substitute(y,c,B)||""):"";if("image"===
b.type)e.sourceURL=k.substitute(g,this._fixTokens(e.sourceURL,p)),e.linkURL&&(e.linkURL=h.trim(k.substitute(g,this._fixTokens(e.linkURL,p))||""));else{var l,a;m.forEach(e.fields,function(p,b){if(-1!==p.indexOf(this._relatedFieldPrefix))a=this._getRelatedChartInfos(p,e,g,B),a instanceof Array?e.fields=a:e.fields[b]=a;else{var f=g[p],f=void 0===f?null:f;l=g[e.normalizeField]||0;f&&l&&(f/=l);e.fields[b]={y:f,tooltip:(this._fieldLabels[p.toLowerCase()]||p)+":\x3cbr/\x3e"+this._formatValue(f,p,B,!!l)}}},
this)}t.push(b)}},this));return{title:l,description:a,hasDescription:!!u.description,fields:A&&A.length?A:null,mediaInfos:t&&t.length?t:null,formatted:y,editSummary:p&&p.getEditSummary?p.getEditSummary(b):""}},_getRelatedChartInfos:function(b,f,c,u){var p,g,y,l,a,r;p=[];r=this._fromRelatedFieldName(b);a=r[0];g=this._relatedInfo[a];a=this._relatedLayersInfo[a];g&&m.forEach(g.relatedFeatures,function(g){g=g.attributes;var a,I;for(I in g)if(g.hasOwnProperty(I)&&I===r[1]){a={};l=g[I];f.normalizeField&&
(y=-1!==f.normalizeField.indexOf(this._relatedFieldPrefix)?g[this._fromRelatedFieldName(f.normalizeField)[1]]:c[f.normalizeField]);l&&y&&(l/=y);if(f.tooltipField)if(-1!==f.tooltipField.indexOf(this._relatedFieldPrefix)){var J=this._fromRelatedFieldName(f.tooltipField)[1],e=k.isDefined(g[J])?this._formatValue(g[J],f.tooltipField,u,!!y):J;a.tooltip=e+":\x3cbr/\x3e"+this._formatValue(l,J,u,!!y)}else a.tooltip=(this._fieldLabels[b.toLowerCase()]||b)+":\x3cbr/\x3e"+this._formatValue(l,f.tooltipField,u,
!!y);else a.tooltip=l;a.y=l;p.push(a)}},this);return"esriRelCardinalityOneToMany"===a.relation.cardinality||"esriRelCardinalityManyToMany"===a.relation.cardinality?p:p[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",
shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",
shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/ig,_reHrefApos:/href\s*=\s*\'([^\']+)\'/ig,_reEmptyHref:/^href\s*=\s*"\s*"$/i,_reEmptyHrefApos:/^href\s*=\s*'\s*'$/i,_fixTokens:function(b,f){var c=this;return b.replace(/(\{([^\{\r\n]+)\})/g,function(b,p,g){b=
c._getLayerFieldInfo(f,g);return"$"+(b?"{"+b.name+"}":p)})},_encodeAttributes:function(b){b=h.clone(b)||{};var f,c;for(f in b)(c=b[f])&&"string"===typeof c&&(c=encodeURIComponent(c).replace(/\'/g,"\x26apos;"),b[f]=c);return b},_processFieldsInLinks:function(b,f){var c=this._encodeAttributes(f),c=h.hitch(this,this._addValuesToHref,f,c);b&&(b=b.replace(this._reHref,c).replace(this._reHrefApos,c));return b},_addValuesToHref:function(b,f,c,u){u=u&&h.trim(u);c=k.substitute(u&&0===u.indexOf("${")?b:f,c);
this._reEmptyHref.test(c)?c='href\x3d"about:blank"':this._reEmptyHrefApos.test(c)&&(c="href\x3d'about:blank'");return c},_getLayerFieldInfo:function(b,f){return b&&b.getField?b.getField(f):null},_formatValue:function(b,f,c,u){var p=this._fieldsMap[f.toLowerCase()],g=p&&p.format;f=-1!==m.indexOf(c.dateFormat.properties,f);var a="number"===typeof b&&!f&&(!g||!g.dateFormat);if(!k.isDefined(b)||!p||!k.isDefined(g))return a?this._forceLTR(b):b;var l="",p=[],y=g.hasOwnProperty("places")||g.hasOwnProperty("digitSeparator"),
r=g.hasOwnProperty("digitSeparator")?g.digitSeparator:!0;if(y&&!f)l="NumberFormat",p.push("places: "+(k.isDefined(g.places)&&(!u||0<g.places)?Number(g.places):"Infinity")),p.length&&(l+="("+p.join(",")+")");else if(g.dateFormat)l="DateFormat"+this._insertOffset(this._dateFormats[g.dateFormat]||this._dateFormats.shortDateShortTime);else return a?this._forceLTR(b):b;var e=this._applyFormatting(b,l,c);y&&-1<b.constructor.toString().indexOf("Array")&&(e="",m.forEach(b,h.hitch(this,function(g,p){p&&(e+=
" ");e+=this._applyFormatting(g,l,c)})));y&&!r&&x.group&&(e=e.replace(new RegExp("\\"+x.group,"g"),""));f&&(e='\x3cspan class\x3d"esriDateValue"\x3e'+e+"\x3c/span\x3e");return a?this._forceLTR(e):e},_applyFormatting:function(b,f,c){return k.substitute({myKey:b},"${myKey:"+f+"}",c)||""},_forceLTR:function(b){var f=q("ie");return f&&10>=f?b:"\x3cspan class\x3d'esriNumericValue'\x3e"+b+"\x3c/span\x3e"},_insertOffset:function(b){b&&(b=k.isDefined(this.utcOffset)?b.replace(/\)\s*$/,", utcOffset:"+this.utcOffset+
")"):b);return b},_getDomainName:function(b,f,c,u,p,g){return(b=b.getDomain&&b.getDomain(p,{feature:f}))&&b.codedValues?b.getName(g):null},_getTypeName:function(b,f,c){return(b=b.getType&&b.getType(f))&&b.name},_getRelatedRecords:function(b){var f=b.graphic,c;this._relatedLayersInfoPromise||(this._relatedLayersInfoPromise=this._getRelatedLayersInfo(b).then(h.hitch(this,function(b){for(c in b)b.hasOwnProperty(c)&&b[c]&&(this._relatedLayersInfo[c].relatedLayerInfo=b[c])})));return this._relatedLayersInfoPromise.then(h.hitch(this,
function(){return this._queryRelatedLayers(f)})).then(h.hitch(this,function(b){this._setRelatedRecords(f,b);return b}))},_getRelatedLayersInfo:function(b){var f=b.fieldsInfo,a,u,p={};a=b.graphic.getSourceLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});m.forEach(f,function(g){var p,b,f,u;p=this._fromRelatedFieldName(g.fieldName);b=p[0];p=p[1];b&&(!this._relatedLayersInfo[b]&&a&&a.relationships&&(m.some(a.relationships,function(g){if(g.id==b)return u=g,!0}),u&&(this._relatedLayersInfo[b]=
{relation:u,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[b]&&(this._relatedLayersInfo[b].relatedFields.push(p),g.statisticType&&(f=new c,f.statisticType=g.statisticType,f.onStatisticField=p,f.outStatisticFieldName=p,this._relatedLayersInfo[b].outStatistics.push(f))))},this);for(u in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(u)&&this._relatedLayersInfo[u]&&(b=this._relatedLayersInfo[u].relation,b=a.url.replace(/[0-9]+$/,b.relatedTableId),this._relatedLayersInfo[u].relatedLayerUrl=
b,p[u]=B({url:b,content:{f:"json"},callbackParamName:"callback"}));return v(p)},_queryRelatedLayers:function(b){var f={},c;for(c in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(c)&&(f[c]=this._queryRelatedLayer({graphic:b,relatedInfo:this._relatedLayersInfo[c]}));return v(f)},_queryRelatedLayer:function(b){var f,c,u,p,g,a,l,e,r,d,x,q,k;f=b.graphic;c=f.getSourceLayer();u=c.url.match(/[0-9]+$/g)[0];x=b.relatedInfo;d=x.relatedLayerInfo;q=x.relatedLayerUrl;b=x.relation;m.some(d.relationships,
function(g){if(g.relatedTableId===parseInt(u,10))return p=g,!0},this);p&&(g=new A,m.some(d.fields,function(g){if(g.name===p.keyField)return e=-1!==m.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],g.type)?"number":"string",!0}),p.relationshipTableId&&p.keyFieldInRelationshipTable?(k=new w,this._queryRelatedRecords(f,p).then(h.hitch(this,function(p){var b;(b=p[f.attributes[c.objectIdField]])?(p=m.map(b.features,function(g){return g.attributes[d.objectIdField]},
this),x.outStatistics&&0<x.outStatistics.length&&d.supportsStatistics&&(r=new A,r.objectIds=p,r.outFields=g.outFields,r.outStatistics=x.outStatistics),r&&(a=new D(q),a.execute(r).then(h.hitch(this,function(g){var p=[];p.push(b);p.push(g);k.resolve(p)})))):k.resolve()}))):(l="string"===e?p.keyField+"\x3d'"+f.attributes[b.keyField]+"'":p.keyField+"\x3d"+f.attributes[b.keyField],g.where=l,g.outFields=x.relatedFields,x.outStatistics&&0<x.outStatistics.length&&d.supportsStatistics&&(r=new A,r.where=g.where,
r.outFields=g.outFields,r.outStatistics=x.outStatistics),a=new D(q),l=[],l.push(a.execute(g)),r&&l.push(a.execute(r))));return l?v(l):k?k.promise:void 0},_setRelatedRecords:function(b,f){this._relatedInfo=[];for(var c in f)if(f.hasOwnProperty(c)&&f[c]){var u=f[c];this._relatedInfo[c]={};this._relatedInfo[c].relatedFeatures=u[0].features;k.isDefined(u[1])&&(this._relatedInfo[c].relatedStatsFeatures=u[1].features)}},_handlerErrorResponse:function(b,c){b.reject(c)},_fromRelatedFieldName:function(b){var c=
[];-1!==b.indexOf(this._relatedFieldPrefix)&&(b=b.split("/"),c=b.slice(1));return c},_toRelatedFieldName:function(b){var c="";b&&0<b.length&&(c=this._relatedFieldPrefix+b[0]+"/"+b[1]);return c},_queryRelatedRecords:function(b,c){var f=b.getSourceLayer(),u=new E;u.outFields=["*"];u.relationshipId=c.id;u.objectIds=[b.attributes[f.objectIdField]];return f.queryRelatedFeatures(u)}});a("extend-esri")&&(C.PopupInfo=C.PopupInfoTemplate=n);return n})},"dojox/html/entities":function(){define(["dojo/_base/lang"],
function(n){var h=n.getObject("dojox.html.entities",!0),m=function(d,a){var h,q;if(a._encCache&&a._encCache.regexp&&a._encCache.mapper&&a.length==a._encCache.length)h=a._encCache.mapper,q=a._encCache.regexp;else{h={};q=["["];var v;for(v=0;v<a.length;v++)h[a[v][0]]="\x26"+a[v][1]+";",q.push(a[v][0]);q.push("]");q=new RegExp(q.join(""),"g");a._encCache={mapper:h,regexp:q,length:a.length}}return d=d.replace(q,function(a){return h[a]})},t=function(d,a){var h,q;if(a._decCache&&a._decCache.regexp&&a._decCache.mapper&&
a.length==a._decCache.length)h=a._decCache.mapper,q=a._decCache.regexp;else{h={};q=["("];var v;for(v=0;v<a.length;v++){var e="\x26"+a[v][1]+";";v&&q.push("|");h[e]=a[v][0];q.push(e)}q.push(")");q=new RegExp(q.join(""),"g");a._decCache={mapper:h,regexp:q,length:a.length}}return d=d.replace(q,function(a){return h[a]})};h.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];h.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],
["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0",
"Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da",
"Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4",
"ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f",
"Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3",
"sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0",
"lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245",
"cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],
["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];h.encode=function(d,a){d&&(a?
d=m(d,a):(d=m(d,h.html),d=m(d,h.latin)));return d};h.decode=function(d,a){d&&(a?d=t(d,a):(d=t(d,h.html),d=t(d,h.latin)));return d};return h})},"esri/promiseList":function(){define(["dojo/_base/array","dojo/Deferred","dojo/when"],function(n,h,m){var t=n.forEach;return function(d){function a(a,e){v[e]=a;C.progress([a,e]);0===--B&&C.resolve(v)}var n,q;d instanceof Array?q=d:d&&"object"===typeof d&&(n=d);var v,e=[];if(n){q=[];for(var k in n)Object.hasOwnProperty.call(n,k)&&(e.push(k),q.push(n[k]));v=
{}}else q&&(v=[]);if(!q||!q.length)return(new h).resolve(v);var C=new h;C.promise.always(function(){v=e=null});var B=q.length;t(q,function(d,A){n||e.push(A);m(d,function(d){C.isFulfilled()||a(d,e[A])},function(d){C.isFulfilled()||a(d,e[A])})});return C.promise}})},"esri/tasks/QueryTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),
function(n,h,m,t,d,a,w,q,v,e,k,C,B){var z=n(null,{url:null,query:null,requestOptions:null,pagination:null,pageSize:null,_fetchDfd:null,_startPage:null,_result:null,constructor:function(a){this._handleSuccess=h.hitch(this,this._handleSuccess);this._handleError=h.hitch(this,this._handleError);h.mixin(this,a);null==this.pagination&&(this.pagination=!1);null==this.pageSize&&(this.pageSize=1E3)},execute:function(){var a=new t(this._canceler);this._fetchDfd=a;this._result=null;this._sendRequest();return a.promise},
_canceler:function(a){var e=a._pendingRequest,d;a.isFulfilled()||!e||e.isFulfilled()||(e.cancel(),d=e.results&&e.results[1]);a._pendingRequest=null;return d},_sendRequest:function(a){var e=this.query;this.pagination&&(this._startPage=e.resultOffset=null==a?0:a,e.resultRecordCount=this.pageSize);this._fetchDfd._pendingRequest=q({url:this.url,content:e,callbackParamName:"callback"},this.requestOptions);this._fetchDfd._pendingRequest.then(this._handleSuccess).otherwise(this._handleError)},_handleSuccess:function(a){this.pagination?
(a.exceededTransferLimit&&this._sendRequest(this._startPage+this.pageSize),this._result?this._result.features=this._result.features.concat(a.features):this._result=a,this._fetchDfd.progress(a),a.exceededTransferLimit||this._fetchDfd.resolve(this._result)):(this._fetchDfd.progress(a),this._fetchDfd.resolve(a))},_handleError:function(a){this._fetchDfd.reject(a)}});n=n(C,{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],"execute-for-ids-complete":["objectIds"],
"execute-relationship-query-complete":["featureSets"]},constructor:function(a,e){this._handler=h.hitch(this,this._handler);this._relationshipQueryHandler=h.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=h.hitch(this,this._executeForIdsHandler);this._countHandler=h.hitch(this,this._countHandler);this._extentHandler=h.hitch(this,this._extentHandler);this.source=e&&e.source;this.gdbVersion=e&&e.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:4,a:[{i:0,p:["geometry"]}],
e:2},{n:"rawExecute",c:2,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onRawExecuteComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},onExecuteForExtentComplete:function(){},execute:function(a,e,k,c,l){c=l.assembly;a=this._encode(h.mixin({},
this._url.query,{f:"json"},a.toJson(c&&c[0])));var r=this._handler,x=this._errorHandler;this.source&&(c={source:this.source.toJson()},a.layer=d.toJson(c));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return q({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(b,c){r(b,c,e,k,l.dfd)},error:function(b){x(b,k,l.dfd)}},this.requestOptions)},rawExecute:function(a,e,k){e=e||{};a=this._encode(h.mixin({},this._url.query,{f:"json"},a.toJson(k.assembly&&k.assembly[0])));this.source&&
(a.layer=d.toJson({source:this.source.toJson()}));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return(new z({url:this._url.path+"/query",query:a,requestOptions:this.requestOptions,pagination:e.pagination,pageSize:e.pageSize})).execute().then(null,null,function(c){k.dfd.progress(c)}).then(h.hitch(this,function(c){this._successHandler([c],"onRawExecuteComplete",null,k.dfd)})).otherwise(h.hitch(this,function(c){this._errorHandler(c,null,k.dfd)}))},executeRelationshipQuery:function(a,e,d){a=this._encode(h.mixin({},
this._url.query,{f:"json"},a.toJson()));var c=this._relationshipQueryHandler,l=this._errorHandler;this.gdbVersion&&(a.gdbVersion=this.gdbVersion);var r=new t(v._dfdCanceller);r._pendingDfd=q({url:this._url.path+"/queryRelatedRecords",content:a,callbackParamName:"callback",load:function(a,b){c(a,b,e,d,r)},error:function(c){l(c,d,r)}},this.requestOptions);return r},executeForIds:function(a,e,k,c){var l=c.assembly;a=this._encode(h.mixin({},this._url.query,{f:"json",returnIdsOnly:!0},a.toJson(l&&l[0])));
var r=this._executeForIdsHandler,x=this._errorHandler;this.source&&(l={source:this.source.toJson()},a.layer=d.toJson(l));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return q({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(b,f){r(b,f,e,k,c.dfd)},error:function(b){x(b,k,c.dfd)}},this.requestOptions)},executeForCount:function(a,e,k,c){var l=c.assembly;a=this._encode(h.mixin({},this._url.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},a.toJson(l&&l[0])));var r=
this._countHandler,x=this._errorHandler;this.source&&(l={source:this.source.toJson()},a.layer=d.toJson(l));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return q({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(b,f){r(b,f,e,k,c.dfd)},error:function(b){x(b,k,c.dfd)}},this.requestOptions)},executeForExtent:function(a,e,k,c){var l=c.assembly;a=this._encode(h.mixin({},this._url.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},a.toJson(l&&l[0])));var r=this._extentHandler,
x=this._errorHandler;this.source&&(l={source:this.source.toJson()},a.layer=d.toJson(l));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return q({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(b,f){r(b,f,e,k,c.dfd)},error:function(b){x(b,k,c.dfd)}},this.requestOptions)},_handler:function(a,e,k,c,l){try{var r=new B(a);this._successHandler([r],"onComplete",k,l)}catch(x){this._errorHandler(x,c,l)}},_relationshipQueryHandler:function(a,e,k,c,l){try{var r=a.geometryType,
d=a.spatialReference,b={};m.forEach(a.relatedRecordGroups,function(c){var a={};a.geometryType=r;a.spatialReference=d;a.features=c.relatedRecords;a=new B(a);if(null!=c.objectId)b[c.objectId]=a;else for(var f in c)c.hasOwnProperty(f)&&"relatedRecords"!==f&&(b[c[f]]=a)});this._successHandler([b],"onExecuteRelationshipQueryComplete",k,l)}catch(f){this._errorHandler(f,c,l)}},_executeForIdsHandler:function(a,e,k,c,l){try{this._successHandler([a.objectIds],"onExecuteForIdsComplete",k,l)}catch(r){this._errorHandler(r,
c,l)}},_countHandler:function(a,e,k,c,l){try{var r,d=a.features,b=a.objectIds;if(b)r=b.length;else{if(d)throw Error("Unable to perform query. Please check your parameters.");r=a.count}this._successHandler([r],"onExecuteForCountComplete",k,l)}catch(f){this._errorHandler(f,c,l)}},_extentHandler:function(a,k,d,c,l){try{a.extent&&(a.extent=new e(a.extent)),this._successHandler([a],"onExecuteForExtentComplete",d,l)}catch(r){this._errorHandler(r,c,l)}}});k._createWrappers(n);a("extend-esri")&&h.setObject("tasks.QueryTask",
n,w);return n})},"esri/tasks/Task":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../deferredUtils ../urlUtils ../Evented".split(" "),function(n,h,m,t,d,a,w,q){n=n(q,{declaredClass:"esri.tasks._Task",_eventMap:{error:["error"],complete:["result"]},constructor:function(a,e){a&&h.isString(a)&&(this._url=w.urlToObject(this.url=a));e&&e.requestOptions&&(this.requestOptions=e.requestOptions);this.normalization=!0;this._errorHandler=h.hitch(this,this._errorHandler);
this.registerConnectEvents()},_useSSL:function(){var a=this._url,e=/^http:/i;this.url&&(this.url=this.url.replace(e,"https:"));a&&a.path&&(a.path=a.path.replace(e,"https:"))},_encode:function(a,e,k){var d,q,v={},n,t;for(n in a)if("declaredClass"!==n&&(d=a[n],q=typeof d,null!==d&&void 0!==d&&"function"!==q))if(h.isArray(d))for(v[n]=[],t=d.length,q=0;q<t;q++)v[n][q]=this._encode(d[q]);else"object"===q?d.toJson&&(q=d.toJson(k&&k[n]),"esri.tasks.FeatureSet"===d.declaredClass&&q.spatialReference&&(q.sr=
q.spatialReference,delete q.spatialReference),v[n]=e?q:m.toJson(q)):v[n]=d;return v},_successHandler:function(d,e,k,q){e&&this[e].apply(this,d);k&&k.apply(null,d);q&&a._resDfd(q,d)},_errorHandler:function(a,e,d){this.onError(a);e&&e(a);d&&d.errback(a)},setNormalization:function(a){this.normalization=a},onError:function(){}});t("extend-esri")&&(d.Task=n);return n})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/Polygon ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),
function(n,h,m,t,d,a,w,q,v,e,k,C){n=n(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(a,e){if(a){h.mixin(this,a);var d=this.features,n=a.spatialReference,n=this.spatialReference=k.createInstance(q.simpleConstructor,n),v=k.getGeometryType(a.geometryType);this.geometryType=a.geometryType;a.fields&&(this.fields=a.fields);var c=k.supportsLazyUnquantization(this.geometryType),l=k.unquantizeFunction(this.geometryType,this.transform),r=!!(e&&c&&l),x=v&&(r?v.accessorConstructor:v.simpleConstructor);
m.forEach(d,function(b,a){var c=k.createInstance(w.simpleConstructor),f=b.geometry;if(v&&f){var p=c.geometry=k.createInstance(x,r?null:f);p.setSpatialReference(f.spatialReference?k.createInstance(q.simpleConstructor,f.spatialReference):n);r&&p.setupLazyUnquantization(l,f)}c.symbol=b.symbol?C.fromJson(b.symbol):null;c.attributes=b.attributes;d[a]=c});r||this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(e){var d={};
this.displayFieldName&&(d.displayFieldName=this.displayFieldName);this.fields&&(d.fields=this.fields);this.spatialReference?d.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(d.spatialReference=this.features[0].geometry.spatialReference.toJson());this.features[0]&&(this.features[0].geometry&&(d.geometryType=k.getJsonType(this.features[0].geometry)),d.features=v._encodeGraphics(this.features,e));d.geometryType=d.geometryType||this.geometryType;d.exceededTransferLimit=
this.exceededTransferLimit;d.transform=this.transform;return a.fixJson(d)},_hydrate:function(){k.unquantize(this.features,this.geometryType,this.transform);this.transform=null},quantize:function(a){if(!this.geometryType)return this.transform=null,this;var e=a.translate[0],d=a.translate[1],k=a.scale[0],q=a.scale[1],c=this.features,l=function(b,a,c){var p,g,f,u,e,l,d=[];p=0;for(g=b.length;p<g;p++)if(f=b[p],0<p){if(l=a(f[0]),f=c(f[1]),l!==u||f!==e)d.push([l-u,f-e]),u=l,e=f}else u=a(f[0]),e=c(f[1]),d.push([u,
e]);return 0<d.length?d:null},r=function(b,a,c){if("esriGeometryPoint"===b)return function(b){b.x=a(b.x);b.y=c(b.y);return b};if("esriGeometryPolyline"===b||"esriGeometryPolygon"===b)return function(b){var g,p,f,u,e;f=b.rings||b.paths;e=[];g=0;for(p=f.length;g<p;g++)u=f[g],(u=l(u,a,c))&&e.push(u);return 0<e.length?(b.rings?b.rings=e:b.paths=e,b):null};if("esriGeometryMultipoint"===b)return function(b){var g;g=l(b.points,a,c);return 0<g.length?(b.points=g,b):null};if("esriGeometryEnvelope"===b)return function(b){return b}}(this.geometryType,
function(b){return Math.round((b-e)/k)},function(b){return Math.round((d-b)/q)}),h,b;h=0;for(b=c.length;h<b;h++)c[h].geometry&&(r(c[h].geometry)||c[h].setGeometry(null));this.transform=a;return this}});n.createGraphics=function(a){var e=a.geometryType,d=k.createInstance(q.simpleConstructor,a.spatialReference),h=k.getGeometryType(e).accessorConstructor,n=k.unquantizeFunction(e,a.transform);return m.map(a.features,function(a,e){var c=k.createInstance(w.simpleConstructor),l=a.geometry;if(l){var b=c.geometry=
k.createInstance(h);b.setSpatialReference(d);b.setupLazyUnquantization(n,l)}c.attributes=a.attributes;return c})};n.createPolygon=function(a,d,q){var h;a&&(h=k.createInstance(e.accessorConstructor),h.setSpatialReference(d),d=k.unquantizeFunction("esriGeometryPolygon",q),h.setupLazyUnquantization(d,a));return h};t("extend-esri")&&h.setObject("tasks.FeatureSet",n,d);return n})},"esri/tasks/RelationshipQuery":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has","../kernel"],
function(n,h,m,t,d){n=n(null,{declaredClass:"esri.tasks.RelationshipQuery",definitionExpression:"",relationshipId:null,returnGeometry:!1,objectIds:null,outSpatialReference:null,outFields:null,orderByFields:null,toJson:function(){var a={definitionExpression:this.definitionExpression,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},d=this.objectIds,q=this.outFields,h=this.outSpatialReference,e=
this.orderByFields;d&&(a.objectIds=d.join(","));q&&(a.outFields=q.join(","));h&&(a.outSR=h.wkid||m.toJson(h.toJson()));e&&(a.orderByFields=e.join(","));a._ts=this._ts;return a}});t("extend-esri")&&h.setObject("tasks.RelationshipQuery",n,d);return n})},"esri/tasks/StatisticDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(n,h,m,t){n=n(null,{declaredClass:"esri.tasks.StatisticDefinition",toJson:function(){return{statisticType:this.statisticType,onStatisticField:this.onStatisticField,
outStatisticFieldName:this.outStatisticFieldName,maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount}}});m("extend-esri")&&h.setObject("tasks.StatisticDefinition",n,t);return n})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../lang ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(n,h,m,t,d,a,w,q,v,e,k,C,B,z,A,D,E,c,l,r,x){var b=0,f=x.widgets.popup,y=x.widgets.templatePicker;h=h([r,A,D],{declaredClass:"esri.dijit._PopupRenderer",constructor:function(){this._nls=t.mixin({},f)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'statusSection hidden' dojoAttachPoint\x3d'_status'\x3e\x3c/div\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this._showStatus(y.loading);this._contentDfd=this.template.getComponents(this.graphic).then(t.hitch(this,this._handleComponentsSuccess)).otherwise(t.hitch(this,this._handleComponentsError))},destroy:function(){this._contentDfd&&this._contentDfd.cancel();this._attachmentsDfd&&this._attachmentsDfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._contentDfd=this._attachmentsDfd=null;this.inherited(arguments)},
_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var b=this._mediaInfos,p=b.length,g=this.domNode,c=this._prevMedia,f=this._nextMedia;if(1<p){var l=0,r=0;d.forEach(b,function(g){"image"===g.type?l++:-1!==g.type.indexOf("chart")&&r++});l&&(e.set(this._imageCount,"innerHTML",l),a.query(".summary .image",
g).removeClass("hidden"));r&&(e.set(this._chartCount,"innerHTML",r),a.query(".summary .chart",g).removeClass("hidden"))}else a.query(".summary",g).addClass("hidden"),k.add(c,"hidden"),k.add(f,"hidden");b=this._mediaPtr;0===b?k.add(c,"hidden"):k.remove(c,"hidden");b===p-1?k.add(f,"hidden"):k.remove(f,"hidden");this._destroyFrame()},_displayMedia:function(){var c=this._mediaInfos[this._mediaPtr],p=c.title,g=c.caption,f=a.query(".mediaSection .hzLine",this.domNode)[0];e.set(this._mediaTitle,"innerHTML",
p);k[p?"remove":"add"](this._mediaTitle,"hidden");e.set(this._mediaCaption,"innerHTML",g);k[g?"remove":"add"](this._mediaCaption,"hidden");k[p&&g?"remove":"add"](f,"hidden");this._rid=null;if("image"===c.type)this._showImage(c);else{var l=this,p=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],g=c.value.theme||this.chartTheme;t.isString(g)&&(g=g.replace(/\./gi,"/"),-1===g.indexOf("/")&&(g="dojox/charting/themes/"+g));g||(g="./Rainbow");p.push(g);try{var d=this._rid=b++;n(p,function(g,
b,a){d===l._rid&&(l._rid=null,l._showChart(c.type,c.value,g,b,a))})}catch(O){console.log("PopupRenderer: error loading modules")}}},_preventNewTab:function(b){return(b=b&&t.trim(b).toLowerCase())&&(0===b.indexOf("mailto:")||0===b.indexOf("tel:"))},_showImage:function(b){k.add(this._mediaFrame,"image");var c=B.get(this._gallery,"height"),g=b.value,f;g.linkURL&&(f=C.create("a",{href:g.linkURL,target:this._preventNewTab(g.linkURL)?"":"_blank"},this._mediaFrame));g=b.refreshInterval?this._addURLParameter(g.sourceURL,
"timestamp",Date.now()):g.sourceURL;C.create("img",{className:"esriPopupMediaImage",src:g},f||this._mediaFrame);var e=a.query(".esriPopupMediaImage",this._mediaFrame)[0];this._imageLoadHandle=m.connect(e,"onload",this,function(){this._clearImageHandles();this._imageLoaded(e,c);this._initImageRefresh(b)})},_addURLParameter:function(b,a,g){var c=-1===b.indexOf("?")?"?":"\x26";return b+c+a+"\x3d"+g},_initImageRefresh:function(b){if(b.refreshInterval){var a=6E4*b.refreshInterval;this._imageRefreshHandle=
setTimeout(t.hitch(this,function(){this._destroyFrame();this._showImage(b)}),a)}},_clearImageHandles:function(){m.disconnect(this._imageLoadHandle);this._imageLoadHandle=null;clearTimeout(this._imageRefreshHandle);this._imageRefreshHandle=null},_showChart:function(b,a,g,c,f){k.remove(this._mediaFrame,"image");g=this._chart=new g(C.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});f&&g.setTheme(f);switch(b){case "piechart":g.addPlot("default",{type:"Pie",labels:!1});g.addSeries("Series A",
a.fields);break;case "linechart":g.addPlot("default",{type:"Markers"});g.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});g.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});d.forEach(a.fields,function(b,g){b.x=g+1});g.addSeries("Series A",a.fields);break;case "columnchart":g.addPlot("default",{type:"Columns",gap:3});g.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});g.addSeries("Series A",a.fields);break;case "barchart":g.addPlot("default",{type:"Bars",
gap:3}),g.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),g.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),g.addSeries("Series A",a.fields)}this._action=new c(g);g.render()},_destroyFrame:function(){this._rid=null;this._clearImageHandles();this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);e.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(b,a){var g=b.height;g<a&&B.set(b,"marginTop",
Math.round((a-g)/2)+"px")},_attListHandler:function(b,a){if(b===this._attachmentsDfd){this._attachmentsDfd=null;var g="";a instanceof Error||!a||!a.length||d.forEach(a,function(b){g+="\x3cli\x3e";g+="\x3ca href\x3d'"+l.addProxy(b.url)+"' target\x3d'_blank'\x3e"+(b.name||"[No name]")+"\x3c/a\x3e";g+="\x3c/li\x3e"});e.set(this._attachmentsList,"innerHTML",g||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_supportedURIInfos:[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,label:f.NLS_moreInfo},{pattern:/^\s*(tel:([^\s]+))\s*$/i,
label:"${hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"${hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,appName:"App Studio Player",label:f.NLS_openLinkInApp},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,appName:"Collector",label:f.NLS_openLinkInApp},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,appName:"Explorer",label:f.NLS_openLinkInApp},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,appName:"Navigator",label:f.NLS_openLinkInApp},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,
appName:"Survey123",label:f.NLS_openLinkInApp},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,appName:"Trek2There",label:f.NLS_openLinkInApp},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,appName:"Workforce",label:f.NLS_openLinkInApp},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,appName:"iForm",label:f.NLS_openLinkInApp},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,appName:"FlowFinity",label:f.NLS_openLinkInApp},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,appName:"Laserfische",label:f.NLS_openLinkInApp},
{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,appName:"Microsoft Power BI",label:f.NLS_openLinkInApp}],_findURIInfo:function(b){var a;d.some(this._supportedURIInfos,function(g){g.pattern.test(b)&&(a=g);return!!a});return a},_createLinkIfURI:function(b){var a=this._findURIInfo(b);if(a){var g=b.match(a.pattern);return b.replace(a.pattern,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+c.substitute({appName:a.appName,hierPart:g&&g[2]},a.label)+"\x3c/a\x3e")}return b},_showStatus:function(b){e.set(this._status,
"innerHTML",b);k.remove(this._status,"hidden");a.query(".mainSection",this.domNode).addClass("hidden")},_hideStatus:function(){e.set(this._status,"innerHTML","");k.add(this._status,"hidden");a.query(".mainSection",this.domNode).removeClass("hidden")},_handleComponentsSuccess:function(b){if(b){this._hideStatus();var c=this.showTitle?b.title:"",g=b.description,l=b.fields,u=b.mediaInfos,r=this.domNode,q=this._nls,h=this,y=this.template,x=this.graphic;this._prevMedia.title=q.NLS_prevMedia;this._nextMedia.title=
q.NLS_nextMedia;e.set(this._title,"innerHTML",c);c||k.add(this._title,"hidden");!b.hasDescription&&l&&(g="",d.forEach(l,function(b){g+="\x3ctr valign\x3d'top'\x3e";g+="\x3ctd class\x3d'attrName'\x3e"+z.encode(b[0])+"\x3c/td\x3e";g+="\x3ctd class\x3d'attrValue'\x3e"+this._createLinkIfURI(b[1])+"\x3c/td\x3e";g+="\x3c/tr\x3e"},this),g&&(g="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+g+"\x3c/table\x3e"));e.set(this._description,"innerHTML",g);g||k.add(this._description,
"hidden");a.query("a",this._description).forEach(function(b){h._preventNewTab(b.href)?"_blank"===b.target&&e.remove(b,"target"):e.set(b,"target","_blank")});c&&g?a.query(".mainSection .hzLine",r).removeClass("hidden"):c||g?a.query(".mainSection .hzLine",r).addClass("hidden"):a.query(".mainSection",r).addClass("hidden");if(c=this._attachmentsDfd=y.getAttachments(x))c.addBoth(t.hitch(this,this._attListHandler,c)),e.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+q.NLS_searching+"...\x3c/li\x3e"),
a.query(".attachmentsSection",r).removeClass("hidden");u&&u.length&&(a.query(".mediaSection",r).removeClass("hidden"),v.setSelectable(this._mediaFrame,!1),this._mediaInfos=u,this._mediaPtr=0,this._updateUI(),this._displayMedia());b.editSummary&&(e.set(this._editSummary,"innerHTML",b.editSummary),u&&u.length&&k.remove(this._mediaBreak,"hidden"),k.remove(this._editSummarySection,"hidden"));this.emit("content-update")}else this._showStatus(f.NLS_noInfo)},_handleComponentsError:function(b){b&&"cancel"===
b.dojoType||(console.log("PopupRenderer: error loading template",b),this._showStatus(f.NLS_noInfo))}});w("extend-esri")&&t.setObject("dijit._PopupRenderer",h,E);return h})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(n,h,m,t,d,a,w,q,v,e,k,C,B){function z(){}function A(a){return function(e,
c,l,d){return e&&"string"==typeof c&&e[c]==z?e.on(c.substring(2).toLowerCase(),w.hitch(l,d)):a.apply(m,arguments)}}n.around(m,"connect",A);a.connect&&n.around(a,"connect",A);n=t("dijit._Widget",[k,C,B],{onClick:z,onDblClick:z,onKeyDown:z,onKeyPress:z,onKeyUp:z,onMouseDown:z,onMouseMove:z,onMouseOut:z,onMouseOver:z,onMouseLeave:z,onMouseEnter:z,onMouseUp:z,constructor:function(a){this._toConnect={};for(var e in a)this[e]===z&&(this._toConnect[e.replace(/^on/,"").toLowerCase()]=a[e],delete a[e])},postCreate:function(){this.inherited(arguments);
for(var a in this._toConnect)this.on(a,this._toConnect[a]);delete this._toConnect},on:function(a,e){return this[this._onMap(a)]===z?m.connect(this.domNode,a.toLowerCase(),this,e):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(e,d){a.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(e,d)},attr:function(a,e){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,
arguments):this.get(a)},getDescendants:function(){a.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?q("[widgetId]",this.containerNode).map(e.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});d("dijit-legacy-requires")&&v(0,function(){require(["dijit/_base"])});return n})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(n,h,m,t,d,a,w,q,v,e,k,C,B,z,A,D,E,c,l,r,x,b,f){function y(b){return function(a){q[a?"set":"remove"](this.domNode,b,a);this._set(b,a)}}B.add("dijit-legacy-requires",!z.isAsync);B.add("dojo-bidi",!1);B("dijit-legacy-requires")&&E(0,function(){n(["dijit/_base/manager"])});var u={};t=a("dijit._WidgetBase",[c,x],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:y("lang"),dir:"",_setDirAttr:y("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(b){this._set("ownerDocument",b)},attributeMap:{},_blankGif:t.blankGif||n.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var b=this.constructor;if(!b._setterAttrs){var a=b.prototype,c=b._setterAttrs=[],b=b._onMap={},f;for(f in a.attributeMap)c.push(f);for(f in a)/^on/.test(f)&&(b[f.substring(2).toLowerCase()]=f),/^_set[A-Z](.*)Attr$/.test(f)&&(f=f.charAt(4).toLowerCase()+
f.substr(5,f.length-9),a.attributeMap&&f in a.attributeMap||c.push(f))}},postscript:function(b,a){this.create(b,a)},create:function(b,a){this._introspect();this.srcNodeRef=w.byId(a);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);b&&(this.params=b,A.mixin(this,b));this.postMixInProperties();this.id||(this.id=f.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=
this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=r.body(this.ownerDocument);f.add(this);this.buildRendering();var g;if(this.domNode){this._applyAttributes();var c=this.srcNodeRef;c&&c.parentNode&&this.domNode!==c&&(c.parentNode.replaceChild(this.domNode,c),g=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();g&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var b={},a;for(a in this.params||{})b[a]=this._get(a);
h.forEach(this.constructor._setterAttrs,function(a){if(!(a in b)){var g=this._get(a);g&&this.set(a,g)}},this);for(a in b)this.set(a,b[a])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var b=this.baseClass.split(" ");this.isLeftToRight()||(b=b.concat(h.map(b,function(b){return b+"Rtl"})));v.add(this.domNode,b)}},postCreate:function(){},startup:function(){this._started||(this._started=
!0,h.forEach(this.getChildren(),function(b){b._started||b._destroyed||!A.isFunction(b.startup)||(b.startup(),b._started=!0)}))},destroyRecursive:function(b){this._beingDestroyed=!0;this.destroyDescendants(b);this.destroy(b)},destroy:function(b){function a(a){a.destroyRecursive?a.destroyRecursive(b):a.destroy&&a.destroy(b)}this._beingDestroyed=!0;this.uninitialize();h.forEach(this._connects,A.hitch(this,"disconnect"));h.forEach(this._supportingWidgets,a);this.domNode&&h.forEach(f.findWidgets(this.domNode,
this.containerNode),a);this.destroyRendering(b);f.remove(this.id);this._destroyed=!0},destroyRendering:function(b){this.bgIframe&&(this.bgIframe.destroy(b),delete this.bgIframe);this.domNode&&(b?q.remove(this.domNode,"widgetId"):e.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(b||e.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(b){h.forEach(this.getChildren(),function(a){a.destroyRecursive&&a.destroyRecursive(b)})},uninitialize:function(){return!1},_setStyleAttr:function(b){var a=
this.domNode;A.isObject(b)?C.set(a,b):a.style.cssText=a.style.cssText?a.style.cssText+("; "+b):b;this._set("style",b)},_attrToDom:function(b,a,c){c=3<=arguments.length?c:this.attributeMap[b];h.forEach(A.isArray(c)?c:[c],function(c){var g=this[c.node||c||"domNode"];switch(c.type||"attribute"){case "attribute":A.isFunction(a)&&(a=A.hitch(this,a));c=c.attribute?c.attribute:/^on[A-Z][a-zA-Z]*$/.test(b)?b.toLowerCase():b;g.tagName?q.set(g,c,a):g.set(c,a);break;case "innerText":g.innerHTML="";g.appendChild(this.ownerDocument.createTextNode(a));
break;case "innerHTML":g.innerHTML=a;break;case "class":v.replace(g,a,this[b]);break;case "toggleClass":v.toggle(g,c.className||b,a)}},this)},get:function(b){var a=this._getAttrNames(b);return this[a.g]?this[a.g]():this._get(b)},set:function(b,a){if("object"===typeof b){for(var c in b)this.set(c,b[c]);return this}c=this._getAttrNames(b);var g=this[c.s];if(A.isFunction(g))var f=g.apply(this,Array.prototype.slice.call(arguments,1));else{var g=this.focusNode&&!A.isFunction(this.focusNode)?"focusNode":
"domNode",e=this[g]&&this[g].tagName,l;if((l=e)&&!(l=u[e])){l=this[g];var p={},d;for(d in l)p[d.toLowerCase()]=!0;l=u[e]=p}d=l;c=b in this.attributeMap?this.attributeMap[b]:c.s in this?this[c.s]:d&&c.l in d&&"function"!=typeof a||/^aria-|^data-|^role$/.test(b)?g:null;null!=c&&this._attrToDom(b,a,c);this._set(b,a)}return f||this},_attrPairNames:{},_getAttrNames:function(b){var a=this._attrPairNames;if(a[b])return a[b];var c=b.replace(/^[a-z]|-[a-zA-Z]/g,function(b){return b.charAt(b.length-1).toUpperCase()});
return a[b]={n:b+"Node",s:"_set"+c+"Attr",g:"_get"+c+"Attr",l:c.toLowerCase()}},_set:function(b,a){var c=this[b];this[b]=a;!this._created||c===a||c!==c&&a!==a||(this._watchCallbacks&&this._watchCallbacks(b,c,a),this.emit("attrmodified-"+b,{detail:{prevValue:c,newValue:a}}))},_get:function(b){return this[b]},emit:function(b,a,c){a=a||{};void 0===a.bubbles&&(a.bubbles=!0);void 0===a.cancelable&&(a.cancelable=!0);a.detail||(a.detail={});a.detail.widget=this;var g,f=this["on"+b];f&&(g=f.apply(this,c?
c:[a]));this._started&&!this._beingDestroyed&&D.emit(this.domNode,b.toLowerCase(),a);return g},on:function(b,a){var c=this._onMap(b);return c?m.after(this,c,a,!0):this.own(D(this.domNode,b,a))[0]},_onMap:function(b){var a=this.constructor,c=a._onMap;if(!c){var c=a._onMap={},f;for(f in a.prototype)/^on/.test(f)&&(c[f.replace(/^on/,"").toLowerCase()]=f)}return c["string"==typeof b&&b.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?
f.findWidgets(this.containerNode):[]},getParent:function(){return f.getEnclosingWidget(this.domNode.parentNode)},connect:function(b,a,c){return this.own(d.connect(b,a,this,c))[0]},disconnect:function(b){b.remove()},subscribe:function(b,a){return this.own(l.subscribe(b,A.hitch(this,a)))[0]},unsubscribe:function(b){b.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():k.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=C.get(this.domNode,"display")},
placeAt:function(b,a){var c=!b.tagName&&f.byId(b);!c||!c.addChild||a&&"number"!==typeof a?(c=c&&"domNode"in c?c.containerNode&&!/after|before|replace/.test(a||"")?c.containerNode:c.domNode:w.byId(b,this.ownerDocument),e.place(this.domNode,c,a),!this._started&&(this.getParent()||{})._started&&this.startup()):c.addChild(this,a);return this},defer:function(b,a){var c=setTimeout(A.hitch(this,function(){c&&(c=null,this._destroyed||A.hitch(this,b)())}),a||0);return{remove:function(){c&&(clearTimeout(c),
c=null);return null}}}});B("dojo-bidi")&&t.extend(b);return t})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(n,h,m){return m("dijit.Destroyable",null,{destroy:function(h){this._destroyed=!0},own:function(){var m=["destroyRecursive","destroy","remove"];n.forEach(arguments,function(d){function a(){q.remove();n.forEach(v,function(a){a.remove()})}var t,q=h.before(this,"destroy",function(a){d[t](a)}),v=[];d.then?(t="cancel",d.then(a,a)):n.forEach(m,
function(e){"function"===typeof d[e]&&(t||(t=e),v.push(h.after(d,e,a,!0)))})},this);return arguments}})})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),function(n,h,m,t,d,a){n=t("dijit._OnDijitClickMixin",null,{connect:function(d,q,h){return this.inherited(arguments,[d,"ondijitclick"==q?a:q,h])}});n.a11yclick=a;return n})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],
function(n,h,m,t){t.extend(h,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return m("dijit._FocusMixin",null,{_focusManager:n})})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(n,h,m,t){m(function(){h("highcontrast")&&n.add(t.body(),"dijit_a11y")});return h})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),
function(n,h,m,t,d,a,w){d.add("highcontrast",function(){var a=w.doc.createElement("div");try{a.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(h.blankGif||n.toUrl("./resources/blank.gif"))+'");';w.body().appendChild(a);var v=t.getComputedStyle(a),e=v.backgroundImage;return v.borderTopColor==v.borderRightColor||e&&("none"==e||"url(invalid-url:)"==e)}catch(k){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+
k.toString()),!1}finally{8>=d("ie")?a.outerHTML="":w.body().removeChild(a)}});a(function(){d("highcontrast")&&m.add(w.body(),"dj_a11y")});return d})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(n,h,m,t,d,a,w){a.extend(n,{waiRole:"",waiState:""});return d("dijit._Templated",[h,m],{constructor:function(){w.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin",
"","2.0")},_processNode:function(a,d){var e=this.inherited(arguments),h=d(a,"waiRole");h&&a.setAttribute("role",h);(h=d(a,"waiState"))&&t.forEach(h.split(/\s*,\s*/),function(e){-1!=e.indexOf("-")&&(e=e.split("-"),a.setAttribute("aria-"+e[0],e[1]))});return e}})})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(n,h,m,t,d,a,w,q){var v=h("dijit._TemplatedMixin",q,{templateString:null,
templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(a){var e=this.declaredClass,d=this;return w.substitute(a,this,function(a,h){"!"==h.charAt(0)&&(a=t.getObject(h.substr(1),!1,d));if("undefined"==typeof a)throw Error(e+" template:"+h);return null==a?"":"!"==h.charAt(0)?a:this._escapeValue(""+a)},this)},_escapeValue:function(a){return a.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||
(this.templateString=n(this.templatePath,{sanitize:!0}));var a=v.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),d;if(t.isString(a)){if(d=m.toDom(this._stringRepl(a),this.ownerDocument),1!=d.nodeType)throw Error("Invalid template: "+a);}else d=a.cloneNode(!0);this.domNode=d}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(a){var e=this.containerNode;if(a&&e)for(;a.hasChildNodes();)e.appendChild(a.firstChild)}});
v._templateCache={};v.getCachedTemplate=function(a,d,h){var e=v._templateCache,q=a,k=e[q];if(k){try{if(!k.ownerDocument||k.ownerDocument==(h||document))return k}catch(D){}m.destroy(k)}a=w.trim(a);if(d||a.match(/\$\{([^\}]+)\}/g))return e[q]=a;d=m.toDom(a,h);if(1!=d.nodeType)throw Error("Invalid template: "+a);return e[q]=d};a("ie")&&d(window,"unload",function(){var a=v._templateCache,d;for(d in a){var h=a[d];"object"==typeof h&&m.destroy(h);delete a[d]}});return v})},"dojo/cache":function(){define(["./_base/kernel",
"./text"],function(n){return n.cache})},"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(n,h,m,t,d,a,w,q,v){var e=d.delegate(q,{mouseenter:a.enter,mouseleave:a.leave,keypress:m._keypress}),k;m=t("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);
this._beforeFillContent()},_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var d=a;;)if(1==d.nodeType&&(this._processTemplateNode(d,function(a,d){return a.getAttribute(d)},this._attach)||this.searchContainerNode)&&d.firstChild)d=d.firstChild;else{if(d==a)break;for(;!d.nextSibling;)if(d=d.parentNode,d==a)return;d=d.nextSibling}},_processTemplateNode:function(a,e,h){var q=!0,k=this.attachScope||this,n=e(a,"dojoAttachPoint")||e(a,"data-dojo-attach-point");if(n)for(var c=n.split(/\s*,\s*/);n=
c.shift();)d.isArray(k[n])?k[n].push(a):k[n]=a,q="containerNode"!=n,this._attachPoints.push(n);if(e=e(a,"dojoAttachEvent")||e(a,"data-dojo-attach-event"))for(n=e.split(/\s*,\s*/),c=d.trim;e=n.shift();)if(e){var l=null;-1!=e.indexOf(":")?(l=e.split(":"),e=c(l[0]),l=c(l[1])):e=c(e);l||(l=e);this._attachEvents.push(h(a,e,d.hitch(k,l)))}return q},_attach:function(a,d,h){d=d.replace(/^on/,"").toLowerCase();d="dijitclick"==d?k||(k=n("./a11yclick")):e[d]||d;return w(a,d,h)},_detachTemplateNodes:function(){var a=
this.attachScope||this;h.forEach(this._attachPoints,function(d){delete a[d]});this._attachPoints=[];h.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});d.extend(v,{dojoAttachEvent:"",dojoAttachPoint:""});return m})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(n,h,m,t,d){return m("dijit._WidgetsInTemplateMixin",
null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var a=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);d.parse(a,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(t.hitch(this,function(a){this._startupWidgets=a;for(var d=0;d<a.length;d++)this._processTemplateNode(a[d],
function(a,d){return a[d]},function(a,d,h){return d in a?a.connect(a,d,h):a.on(d,h,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(a,d,h){return d(a,"dojoType")||d(a,"data-dojo-type")?
!0:this.inherited(arguments)},startup:function(){n.forEach(this._startupWidgets,function(a){a&&!a._started&&a.startup&&a.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(n,h,m,t,d,a,w,q,v,e,k,C,B,z,A,D){function E(a){return eval("("+a+")")}function c(a){var b=
a._nameCaseMap,c=a.prototype;if(!b||b._extendCnt<r){var b=a._nameCaseMap={},d;for(d in c)"_"!==d.charAt(0)&&(b[d.toLowerCase()]=d);b._extendCnt=r}return b}function l(a,c){c||(c=n);var b=c._dojoParserCtorMap||(c._dojoParserCtorMap={}),f=a.join();if(!b[f]){for(var d=[],g=0,e=a.length;g<e;g++){var l=a[g];d[d.length]=b[l]=b[l]||m.getObject(l)||~l.indexOf("/")&&c(l)}g=d.shift();b[f]=d.length?g.createSubclass?g.createSubclass(d):g.extend.apply(g,d):g}return b[f]}new Date("X");var r=0;v.after(m,"extend",
function(){r++},!0);var x={_clearCache:function(){r++;_ctorMap={}},_functionFromScript:function(a,c){var b="",f="",d=a.getAttribute(c+"args")||a.getAttribute("args"),g=a.getAttribute("with"),d=(d||"").split(/\s*,\s*/);g&&g.length&&t.forEach(g.split(/\s*,\s*/),function(a){b+="with("+a+"){";f+="}"});return new Function(d,b+a.innerHTML+f)},instantiate:function(a,c,d){c=c||{};d=d||{};var b=(d.scope||h._scopeName)+"Type",f="data-"+(d.scope||h._scopeName)+"-",g=f+"type",e=f+"mixins",l=[];t.forEach(a,function(a){var f=
b in c?c[b]:a.getAttribute(g)||a.getAttribute(b);if(f){var d=a.getAttribute(e),f=d?[f].concat(d.split(/\s*,\s*/)):[f];l.push({node:a,types:f})}});return this._instantiate(l,c,d)},_instantiate:function(a,c,d,h){function b(a){c._started||d.noStart||t.forEach(a,function(a){"function"!==typeof a.startup||a._started||a.startup()});return a}a=t.map(a,function(a){var b=a.ctor||l(a.types,d.contextRequire);if(!b)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(b,
a.node,c,d,a.scripts,a.inherited)},this);return h?e(a).then(b):b(a)},construct:function(a,f,d,e,l,g){function b(a){C&&m.setObject(C,a);for(y=0;y<G.length;y++)v[G[y].advice||"after"](a,G[y].method,m.hitch(a,G[y].func),!0);for(y=0;y<K.length;y++)K[y].call(a);for(y=0;y<L.length;y++)a.watch(L[y].prop,L[y].func);for(y=0;y<M.length;y++)A(a,M[y].event,M[y].func);return a}var r=a&&a.prototype;e=e||{};var p={};e.defaults&&m.mixin(p,e.defaults);g&&m.mixin(p,g);var u;B("dom-attributes-explicit")?u=f.attributes:
B("dom-attributes-specified-flag")?u=t.filter(f.attributes,function(a){return a.specified}):(g=(/^input$|^img$/i.test(f.nodeName)?f:f.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),u=t.map(g.split(/\s+/),function(a){var b=a.toLowerCase();return{name:a,value:"LI"==f.nodeName&&"value"==a||"enctype"==b?f.getAttribute(b):f.getAttributeNode(b).value}}));var n=e.scope||h._scopeName;g="data-"+n+"-";var x={};"dojo"!==n&&(x[g+"props"]=
"data-dojo-props",x[g+"type"]="data-dojo-type",x[g+"mixins"]="data-dojo-mixins",x[n+"type"]="dojotype",x[g+"id"]="data-dojo-id");for(var y=0,w,n=[],C,H;w=u[y++];){var F=w.name,D=F.toLowerCase();w=w.value;switch(x[D]||D){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":H=w;break;case "data-dojo-id":case "jsid":C=w;break;case "data-dojo-attach-point":case "dojoattachpoint":p.dojoAttachPoint=w;break;case "data-dojo-attach-event":case "dojoattachevent":p.dojoAttachEvent=
w;break;case "class":p["class"]=f.className;break;case "style":p.style=f.style&&f.style.cssText;break;default:if(F in r||(F=c(a)[D]||F),F in r)switch(typeof r[F]){case "string":p[F]=w;break;case "number":p[F]=w.length?Number(w):NaN;break;case "boolean":p[F]="false"!=w.toLowerCase();break;case "function":""===w||-1!=w.search(/[^\w\.]+/i)?p[F]=new Function(w):p[F]=m.getObject(w,!1)||new Function(w);n.push(F);break;default:D=r[F],p[F]=D&&"length"in D?w?w.split(/\s*,\s*/):[]:D instanceof Date?""==w?new Date(""):
"now"==w?new Date:k.fromISOString(w):D instanceof q?h.baseUrl+w:E(w)}else p[F]=w}}for(u=0;u<n.length;u++)x=n[u].toLowerCase(),f.removeAttribute(x),f[x]=null;if(H)try{H=E.call(e.propsThis,"{"+H+"}"),m.mixin(p,H)}catch(N){throw Error(N.toString()+" in data-dojo-props\x3d'"+H+"'");}m.mixin(p,d);l||(l=a&&(a._noScript||r._noScript)?[]:z("\x3e script[type^\x3d'dojo/']",f));var G=[],K=[],L=[],M=[];if(l)for(y=0;y<l.length;y++)x=l[y],f.removeChild(x),d=x.getAttribute(g+"event")||x.getAttribute("event"),e=
x.getAttribute(g+"prop"),H=x.getAttribute(g+"method"),n=x.getAttribute(g+"advice"),u=x.getAttribute("type"),x=this._functionFromScript(x,g),d?"dojo/connect"==u?G.push({method:d,func:x}):"dojo/on"==u?M.push({event:d,func:x}):p[d]=x:"dojo/aspect"==u?G.push({method:H,advice:n,func:x}):"dojo/watch"==u?L.push({prop:e,func:x}):K.push(x);a=(l=a.markupFactory||r.markupFactory)?l(p,f,a):new a(p,f);return a.then?a.then(b):b(a)},scan:function(a,c){function b(a){if(!a.inherited){a.inherited={};var c=a.node,d=
b(a.parent),c={dir:c.getAttribute("dir")||d.dir,lang:c.getAttribute("lang")||d.lang,textDir:c.getAttribute(q)||d.textDir},g;for(g in c)c[g]&&(a.inherited[g]=c[g])}return a.inherited}var d=[],f=[],g={},e=(c.scope||h._scopeName)+"Type",r="data-"+(c.scope||h._scopeName)+"-",x=r+"type",q=r+"textdir",r=r+"mixins",k=a.firstChild,m=c.inherited;if(!m){var v=function(a,b){return a.getAttribute&&a.getAttribute(b)||a.parentNode&&v(a.parentNode,b)},m={dir:v(a,"dir"),lang:v(a,"lang"),textDir:v(a,q)},w;for(w in m)m[w]||
delete m[w]}for(var m={inherited:m},z,A;;)if(k)if(1!=k.nodeType)k=k.nextSibling;else if(z&&"script"==k.nodeName.toLowerCase())(D=k.getAttribute("type"))&&/^dojo\/\w/i.test(D)&&z.push(k),k=k.nextSibling;else if(A)k=k.nextSibling;else{var D=k.getAttribute(x)||k.getAttribute(e);w=k.firstChild;if(D||w&&(3!=w.nodeType||w.nextSibling)){A=null;if(D){var E=k.getAttribute(r);z=E?[D].concat(E.split(/\s*,\s*/)):[D];try{A=l(z,c.contextRequire)}catch(K){}A||t.forEach(z,function(a){~a.indexOf("/")&&!g[a]&&(g[a]=
!0,f[f.length]=a)});E=A&&!A.prototype._noScript?[]:null;m={types:z,ctor:A,parent:m,node:k,scripts:E};m.inherited=b(m);d.push(m)}else m={node:k,scripts:z,parent:m};z=E;A=k.stopParser||A&&A.prototype.stopParser&&!c.template;k=w}else k=k.nextSibling}else{if(!m||!m.node)break;k=m.node.nextSibling;A=!1;m=m.parent;z=m.scripts}var G=new C;f.length?(B("dojo-debug-messages")&&console.warn("WARNING: Modules being Auto-Required: "+f.join(", ")),(c.contextRequire||n)(f,function(){G.resolve(t.filter(d,function(a){if(!a.ctor)try{a.ctor=
l(a.types,c.contextRequire)}catch(N){}for(var b=a.parent;b&&!b.types;)b=b.parent;var d=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(d&&d.stopParser&&!c.template);a.instantiate=!b||b.instantiate&&b.instantiateChildren;return a.instantiate}))})):G.resolve(d);return G.promise},_require:function(a,c){var b=E("{"+a.innerHTML+"}"),d=[],f=[],g=new C,e=c&&c.contextRequire||n,l;for(l in b)d.push(l),f.push(b[l]);e(f,function(){for(var a=0;a<d.length;a++)m.setObject(d[a],arguments[a]);g.resolve(arguments)});
return g.promise},_scanAmd:function(a,c){var b=new C,d=b.promise;b.resolve(!0);var f=this;z("script[type\x3d'dojo/require']",a).forEach(function(a){d=d.then(function(){return f._require(a,c)});a.parentNode.removeChild(a)});return d},parse:function(b,c){!b||"string"==typeof b||"nodeType"in b||(c=b,b=c.rootNode);var d=b?a.byId(b):w.body();c=c||{};var f=c.template?{template:!0}:{},e=[],g=this,l=this._scanAmd(d,c).then(function(){return g.scan(d,c)}).then(function(a){return g._instantiate(a,f,c,!0)}).then(function(a){return e=
e.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});m.mixin(e,l);return e}};h.parser=x;d.parseOnLoad&&D(100,x,"parse");return x})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(n,h){var m={};n.setObject("dojo.date.stamp",m);m.fromISOString=function(n,d){m._isoRegExp||(m._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var a=m._isoRegExp.exec(n),w=null;
if(a){a.shift();a[1]&&a[1]--;a[6]&&(a[6]*=1E3);d&&(d=new Date(d),h.forEach(h.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),function(a){return d["get"+a]()}),function(d,h){a[h]=a[h]||d}));w=new Date(a[0]||1970,a[1]||0,a[2]||1,a[3]||0,a[4]||0,a[5]||0,a[6]||0);100>a[0]&&w.setFullYear(a[0]||1970);var q=0,v=a[7]&&a[7].charAt(0);"Z"!=v&&(q=60*(a[8]||0)+(Number(a[9])||0),"-"!=v&&(q*=-1));v&&(q-=w.getTimezoneOffset());q&&w.setTime(w.getTime()+6E4*q)}return w};m.toISOString=function(h,
d){var a=function(a){return 10>a?"0"+a:a};d=d||{};var n=[],q=d.zulu?"getUTC":"get",m="";"time"!=d.selector&&(m=h[q+"FullYear"](),m=["0000".substr((m+"").length)+m,a(h[q+"Month"]()+1),a(h[q+"Date"]())].join("-"));n.push(m);if("date"!=d.selector){m=[a(h[q+"Hours"]()),a(h[q+"Minutes"]()),a(h[q+"Seconds"]())].join(":");q=h[q+"Milliseconds"]();d.milliseconds&&(m+="."+(100>q?"0":"")+a(q));if(d.zulu)m+="Z";else if("time"!=d.selector)var q=h.getTimezoneOffset(),e=Math.abs(q),m=m+((0<q?"-":"+")+a(Math.floor(e/
60))+":"+a(e%60));n.push(m)}return n.join("T")};return m})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),function(n,h,m,t,d,a){return n([a,d],{_onMap:function(a){var d=this.constructor._onMap,h;d&&d.FINAL||(delete this.constructor._onMap,d=this.registerConnectEvents(),d.FINAL=!0);a=a.toLowerCase();d[a]?h=this[d[a].method]:(a=this._onCamelCase(a),this[a]&&(h=a));return h},on:function(a,d){var h=this._onMap(a),
e=a.replace(/\-/g,""),k="on"+e in this.domNode;return h||!k?this.inherited(arguments):this.own(t(this.domNode,e,d))[0]},emit:function(a,d,n){var e,k,q,m=a.toLowerCase(),t=this.constructor._onMap||this.registerConnectEvents();k=this[this._onMap(m)];d=d||{};d.target||(d.target=this);k&&t&&t[m]&&(this._onObj2Arr(function(){e=Array.prototype.slice.call(arguments)},t[m].argKeys)(d),q=h.mixin({},arguments),q[2]=e,q[0]=t[m].name.replace(/^on/,""));return this.inherited(q||arguments)}})})},"esri/layers/WMSLayerInfo":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/array","dojo/has","../kernel"],function(n,h,m,t,d){n=n(null,{declaredClass:"esri.layers.WMSLayerInfo",name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],allExtents:[],spatialReferences:[],queryable:!1,showPopup:!1,constructor:function(a){a&&(this.name=a.name,this.title=a.title,this.description=a.description,this.extent=a.extent,this.legendURL=a.legendURL,this.subLayers=a.subLayers?a.subLayers:[],this.allExtents=a.allExtents?a.allExtents:[],
this.spatialReferences=a.spatialReferences?a.spatialReferences:[],this.queryable=!!a.queryable,this.showPopup=!!a.showPopup)},clone:function(){var a={name:this.name,title:this.title,description:this.description,legendURL:this.legendURL},d;this.extent&&(a.extent=this.extent.getExtent());a.subLayers=[];m.forEach(this.subLayers,function(d){a.subLayers.push(d.clone())});a.allExtents=[];for(d in this.allExtents)d=parseInt(d,10),isNaN(d)||(a.allExtents[d]=this.allExtents[d].getExtent());a.spatialReferences=
[];m.forEach(this.spatialReferences,function(d){a.spatialReferences.push(d)});a.queryable=this.queryable;a.showPopup=this.showPopup;return a}});t("extend-esri")&&h.setObject("layers.WMSLayerInfo",n,d);return n})},"*noref":1}});
define("esri/layers/WMSLayer","require dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff ../config ../graphic ../kernel ../request ../urlUtils ../dijit/PopupTemplate ../SpatialReference ../geometry/Extent ../geometry/Point ./DynamicMapServiceLayer ./WMSLayerInfo dojo/query".split(" "),function(n,h,m,t,d,a,w,q,v,e,k,C,B,z,A,D,E){m=m([D],{declaredClass:"esri.layers.WMSLayer",_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,4999],[2044,2045],[2081,
2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,
27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],version:null,constructor:function(a,d){var c=k.urlToObject(a);c.query&&(c.query.version||c.query.Version||c.query.VERSION)&&(this.version=c.query.version||c.query.Version||c.query.VERSION);this.url=a=this._stripParameters(a,"version service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "));
this._url=k.urlToObject(a);this._getCapabilitiesURL=a;this._initLayer=t.hitch(this,this._initLayer);this._parseCapabilities=t.hitch(this,this._parseCapabilities);this._getCapabilitiesError=t.hitch(this,this._getCapabilitiesError);d?(this.customParameters=d.customParameters,this.customLayerParameters=d.customLayerParameters,this.imageFormat=this._getImageFormat(d.format),this.imageTransparency=!1!==d.transparent,this.visibleLayers=d.visibleLayers?d.visibleLayers:[],this.version=d.version||this.version,
d.resourceInfo?this._readResourceInfo(d.resourceInfo):this._getCapabilities()):(this.imageFormat="image/png",this.imageTransparency=!0,this.visibleLayers=[],this._getCapabilities());this._blankImageURL=n.toUrl("../images/pixel.png");this.extentProcessor=this._createExtentProcessor(0);this._createChildLayer()},setVisibleLayers:function(a){this.visibleLayers=(a=this._checkVisibleLayersList(a))?a:[];this.refresh(!0)},setImageFormat:function(a){this.imageFormat=this._getImageFormat(a);this.refresh(!0)},
setImageTransparency:function(a){this.imageTransparency=a;this.refresh(!0)},setCustomParameters:function(a,d){this.customParameters=a;this.customLayerParameters=d;this.refresh(!0)},refresh:function(){this.inherited(arguments);this._childLayer&&this._childLayer.refresh.apply(this._childLayer,arguments)},getImageUrl:function(a,d,e,h){if(this.visibleLayers&&0!==this.visibleLayers.length){a=this._getImageParams(a,d,e);a=this._mixinCustomLayerParameters(a);d=this.getMapURL;var b;d+=-1===d.indexOf("?")?
"?":"";for(b in a)a.hasOwnProperty(b)&&(d+="?"===d.substring(d.length-1,d.length)?"":"\x26",d+=b+"\x3d"+a[b]);h(k.addProxy(d))}else h(this._blankImageURL)},_setMap:function(a,d,e){var c=this.inherited(arguments);a.wrapAround180?this._childLayer&&(this.suspended&&this._childLayer.suspend(),this._childLayer._setMap(a,c)):this._childLayer=this.extentProcessor=null;return c},_unsetMap:function(a,d){this._childLayer&&this._childLayer._unsetMap(a,this._div);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);
this._childLayer&&this._childLayer.suspend()},onResume:function(){this.inherited(arguments);this._childLayer&&this._childLayer.resume()},_createChildLayer:function(){this._childLayer=new D(null,{extentProcessor:this._createExtentProcessor(1)});this._childLayer._isChildLayer=!0;this._childLayer.getImageUrl=t.hitch(this,this.getImageUrl);this._childLayer.loaded=!0},_createExtentProcessor:function(a){return t.hitch(this,this._extentProcessor,a)},_extentProcessor:function(a,d){var c=d.extent,e=d.width,
b=0;if(c){var f=c.getWidth()/e,l=c.bisect(),c=l.extents,h=c[a];h&&(e=l.marginLeft/f,b=0===a?e:e+c[0].getWidth()/f,e=Math.ceil(h.getWidth()/f),b=Math.ceil(b));c=h}return{extent:c,width:e,marginLeft:b}},_getImageParams:function(a,e,h){var c=a.spatialReference.wkid;-1===d.indexOf(this.spatialReferences,c)&&a.spatialReference.latestWkid&&(c=a.spatialReference.latestWkid);if(d.some(this._WEB_MERCATOR,function(a){return a==c})){var b=d.filter(this.spatialReferences,function(a){return d.some(this._WEB_MERCATOR,
function(b){return b==a})},this);0===b.length&&(b=d.filter(this.spatialReferences,function(a){return d.some(this._WORLD_MERCATOR,function(b){return b==a})},this));c=0<b.length?b[0]:this._WEB_MERCATOR[1]}this.spatialReferences=d.filter(this.spatialReferences,function(a){return a!==c});this.spatialReferences.unshift(c);var b=a.xmin,f=a.xmax,l=a.ymin;a=a.ymax;var r={SERVICE:"WMS",REQUEST:"GetMap"};r.FORMAT=this.imageFormat;r.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";r.STYLES="";r.VERSION=this.version;
r.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;r.WIDTH=e;r.HEIGHT=h;this.maxWidth<e&&(r.WIDTH=this.maxWidth);this.maxHeight<h&&(r.HEIGHT=this.maxHeight);e=c?c:NaN;isNaN(e)||("1.3.0"==this.version?r.CRS="EPSG:"+e:r.SRS="EPSG:"+e);"1.3.0"==this.version&&this._useLatLong(e)?r.BBOX=l+","+b+","+a+","+f:r.BBOX=b+","+l+","+f+","+a;return r},_initLayer:function(c,d){this.spatialReference=new B(this.extent.spatialReference);this.initialExtent=new z(this.extent);this.fullExtent=new z(this.extent);
this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);var l=t.hitch(this,function(){this.loaded=!0;this.onLoad(this);var a=this._loadCallback;a&&(delete this._loadCallback,a(this))});if(a("chrome")){var h=w.defaults.io,b="with-credentials"===h.useCors?k.canUseXhr(this.getMapURL,!0):-1;(h=-1<b?h.corsEnabledServers[b]:null)&&h.withCredentials?e({url:this.getMapURL,handleAs:"text",content:{SERVICE:"WMS",REQUEST:"GetMap"}}).addBoth(function(){l()}):l()}else l()},_readResourceInfo:function(a){a.extent?
a.layerInfos?(this.extent=a.extent,this.allExtents[0]=a.extent,this.layerInfos=a.layerInfos,this.description=a.description?a.description:"",this.copyright=a.copyright?a.copyright:"",this.title=a.title?a.title:"",this.getMapURL=a.getMapURL?a.getMapURL:this._getCapabilitiesURL,this.getFeatureInfoURL=a.getFeatureInfoURL,this.featureInfoFormat=a.featureInfoFormat,this.version=a.version?a.version:"1.3.0",this.maxWidth=a.maxWidth?a.maxWidth:5E3,this.maxHeight=a.maxHeight?a.maxHeight:5E3,this.spatialReferences=
a.spatialReferences?a.spatialReferences:[],this.imageFormat=this._getImageFormat(a.format),this.setScaleRange(a.minScale,a.maxScale),this.customLayerParameters=a.customLayerParameters||this.customLayerParameters,this.customParameters=a.customParameters||this.customParameters,this._initLayer()):this._errorHandler(Error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo")):this._errorHandler(Error("esri.layers.WMSLayer: Unable to find the 'extent' property in resourceInfo."))},
_getCapabilities:function(){var a=this._url.query?this._url.query:{};a.SERVICE="WMS";a.REQUEST="GetCapabilities";this.version&&(a.VERSION=this.version);var a=this._mixinCustomParameters(a),d=this._url.path+"?",h;for(h in a)a.hasOwnProperty(h)&&(d+="?"==d.substring(d.length-1,d.length)?"":"\x26",d+=h+"\x3d"+a[h]);e({url:d,handleAs:"xml",headers:{"Content-Type":null},load:this._parseCapabilities,error:this._getCapabilitiesError},{usePost:!1})},_parseCapabilities:function(a){if(a){var c=this;this.version=
this._getAttributeValue("WMS_Capabilities","version",a,null);this.version||(this.version=this._getAttributeValue("WMT_MS_Capabilities","version",a,"1.3.0"));var e=this._getTag("Service",a);this.title=this._getTagValue("Title",e,"");this.title||(this.title=this._getTagValue("Name",e,""));this.copyright=this._getTagValue("AccessConstraints",e,"");this.description=this._getTagValue("Abstract",e,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",e,5E3),10);this.maxHeight=parseInt(this._getTagValue("MaxHeight",
e,5E3),10);if(e=this._getTag("Layer",a)){var k=this._getLayerInfo(e),b=0,f=null,e=this._getTag("Capability",a);d.forEach(e.childNodes,function(a){"Layer"==a.nodeName&&(0===b?f=a:(1===b&&k.name&&(k.name="",k.subLayers=[],k.subLayers.push(this._getLayerInfo(f))),k.subLayers.push(this._getLayerInfo(a))),b++)},this);if(k&&(this.layerInfos=k.subLayers,this.layerInfos&&0!==this.layerInfos.length||(this.layerInfos=[k]),this.extent=k.extent,this.extent||(k.extent=new z(this.layerInfos[0].extent.toJson()),
this.extent=k.extent),this.allExtents=k.allExtents,this.allExtents&&this.allExtents.length||(k.allExtents=[],d.forEach(this.layerInfos[0].allExtents,function(a,b){a&&(k.allExtents[b]=new z(a.toJson()))}),this.allExtents=k.allExtents),this.spatialReferences=k.spatialReferences,!this.spatialReferences.length&&0<this.layerInfos.length))for(var n=function(a){var b;for(b=0;b<a.subLayers.length;b++){var c=a.subLayers[b],d=c.spatialReferences;!d.length&&c.subLayers&&0<c.subLayers.length&&(d=n(c));if(d.length)return d}return[]},
e=0;e<this.layerInfos.length;e++){var m=this.layerInfos[e];this.spatialReferences=this.layerInfos[0].spatialReferences;!this.spatialReferences.length&&m.subLayers&&0<m.subLayers.length&&(this.spatialReferences=n(m));if(this.spatialReferences.length)break}e=function(b){return(b=h.query("DCPType",c._getTag(b,a)))&&0<b.length&&(b=h.query("HTTP",b[0]))&&0<b.length&&(b=h.query("Get",b[0]))&&0<b.length&&(b=c._getAttributeValue("OnlineResource","xlink:href",b[0],null))?(b.indexOf("\x26")===b.length-1&&(b=
b.substring(0,b.length-1)),c._stripParameters(b,["service","request"])):null};m=function(b){var f=[];0===h.query("Operation",a).length?d.forEach(h.query("Format",c._getTag(b,a)),function(a){f.push(a.text?a.text:a.textContent)}):d.forEach(h.query("Operation",a),function(a){a.getAttribute("name")===b&&d.forEach(h.query("Format",a),function(a){f.push(a.text?a.text:a.textContent)})});return f};this.getMapURL=e("GetMap")||this._getCapabilitiesURL;this.getMapFormats=m("GetMap");d.some(this.getMapFormats,
function(a){return-1<a.indexOf(this.imageFormat)},this)||(this.imageFormat=this.getMapFormats[0]);if(this.getFeatureInfoURL=e("GetFeatureInfo"))this.getFeatureInfoFormats=m("GetFeatureInfo"),-1<d.indexOf(this.getFeatureInfoFormats,"text/html")?this.featureInfoFormat="text/html":-1<d.indexOf(this.getFeatureInfoFormats,"text/plain")&&(this.featureInfoFormat="text/plain");if(!this.featureInfoFormat){var p=function(a){if(a&&(a.queryable=!1,a.subLayers))for(var b=0;b<a.subLayers.length;b++)p(a.subLayers[b])};
p(k)}this._initLayer()}else this._errorHandler(Error("esri.layers.WMSLayer: Response does not contain any layers."))}else this._errorHandler(Error("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (Response is null.)"))},_getCapabilitiesError:function(a){a&&a.message&&(a.message="GetCapabilities request for "+this._getCapabilitiesURL+" failed. ("+a.message+")");this._errorHandler(a)},_getLayerInfo:function(a){if(!a)return null;var c=new E;c.name="";c.title="";c.description="";c.allExtents=
[];c.spatialReferences=[];c.queryable="1"===a.getAttribute("queryable");c.subLayers=[];var e=this._getTag("LatLonBoundingBox",a);e&&(c.allExtents[0]=this._getExtent(e,4326));var h=this._getTag("EX_GeographicBoundingBox",a),b;h&&(b=new z(0,0,0,0,new B({wkid:4326})),b.xmin=parseFloat(this._getTagValue("westBoundLongitude",h,0)),b.ymin=parseFloat(this._getTagValue("southBoundLatitude",h,0)),b.xmax=parseFloat(this._getTagValue("eastBoundLongitude",h,0)),b.ymax=parseFloat(this._getTagValue("northBoundLatitude",
h,0)),c.allExtents[0]=b);e||h||(b=new z(-180,-90,180,90,new B({wkid:4326})),c.allExtents[0]=b);c.extent=c.allExtents[0];var f=-1<d.indexOf(["1.0.0","1.1.0","1.1.1"],this.version)?"SRS":"CRS";d.forEach(a.childNodes,function(a){if("Name"==a.nodeName)c.name=(a.text?a.text:a.textContent)||"";else if("Title"==a.nodeName)c.title=(a.text?a.text:a.textContent)||"";else if("Abstract"==a.nodeName)c.description=(a.text?a.text:a.textContent)||"";else if("BoundingBox"==a.nodeName){var b=a.getAttribute(f);b&&0===
b.indexOf("EPSG:")?(b=parseInt(b.substring(5),10),0===b||isNaN(b)||(a="1.3.0"==this.version?this._getExtent(a,b,this._useLatLong(b)):this._getExtent(a,b),c.allExtents[b]=a,c.extent||(c.extent=a))):b&&0===b.indexOf("CRS:")?(b=parseInt(b.substring(4),10),0===b||isNaN(b)||(this._CRS_TO_EPSG[b]&&(b=this._CRS_TO_EPSG[b]),c.allExtents[b]=this._getExtent(a,b))):(b=parseInt(b,10),0===b||isNaN(b)||(c.allExtents[b]=this._getExtent(a,b)))}else if(a.nodeName==f)a=(a.text?a.text:a.textContent).split(" "),d.forEach(a,
function(a){a=-1<a.indexOf(":")?parseInt(a.split(":")[1],10):parseInt(a,10);0===a||isNaN(a)||(this._CRS_TO_EPSG[a]&&(a=this._CRS_TO_EPSG[a]),-1==d.indexOf(c.spatialReferences,a)&&c.spatialReferences.push(a))},this);else if("Style"!=a.nodeName||c.legendURL)"Layer"===a.nodeName&&c.subLayers.push(this._getLayerInfo(a));else if(a=this._getTag("LegendURL",a))if(a=this._getTag("OnlineResource",a))c.legendURL=a.getAttribute("xlink:href")},this);c.title=c.title||c.name;return c},_getImageFormat:function(a){switch(a?
a.toLowerCase():""){case "jpg":return"image/jpeg";case "bmp":return"image/bmp";case "gif":return"image/gif";case "svg":return"image/svg+xml";default:return"image/png"}},getImageFormat:function(){switch(this.imageFormat?this.imageFormat.toLowerCase():""){case "image/jpeg":return"jpg";case "image/bmp":return"bmp";case "image/gif":return"gif";case "image/svg+xml":return"svg";default:return"png"}},_getExtent:function(a,d,e){var c;if(a){c=new z;var b=parseFloat(a.getAttribute("minx")),f=parseFloat(a.getAttribute("miny")),
h=parseFloat(a.getAttribute("maxx"));a=parseFloat(a.getAttribute("maxy"));e?(c.xmin=isNaN(f)?-1*Number.MAX_VALUE:f,c.ymin=isNaN(b)?-1*Number.MAX_VALUE:b,c.xmax=isNaN(a)?Number.MAX_VALUE:a,c.ymax=isNaN(h)?Number.MAX_VALUE:h):(c.xmin=isNaN(b)?-1*Number.MAX_VALUE:b,c.ymin=isNaN(f)?-1*Number.MAX_VALUE:f,c.xmax=isNaN(h)?Number.MAX_VALUE:h,c.ymax=isNaN(a)?Number.MAX_VALUE:a);c.spatialReference=new B({wkid:d})}return c},_useLatLong:function(a){var c,d;for(d=0;d<this._REVERSED_LAT_LONG_RANGES.length;d++){var e=
this._REVERSED_LAT_LONG_RANGES[d];if(a>=e[0]&&a<=e[1]){c=!0;break}}return c},_getTag:function(a,d){var c=h.query(a,d);return c&&0<c.length?c[0]:null},_getTagValue:function(a,d,e){return(a=h.query(a,d))&&0<a.length?a[0].text?a[0].text:a[0].textContent:e},_getAttributeValue:function(a,d,e,k){return(a=h.query(a,e))&&0<a.length?a[0].getAttribute(d):k},_checkVisibleLayersList:function(a){if(a&&0<a.length&&this.layerInfos&&0<this.layerInfos.length&&"number"==typeof a[0]){var c=[];d.forEach(a,function(a){a<
this.layerInfos.length&&c.push(this.layerInfos[a].name)},this);a=c}return a},_stripParameters:function(a,e){var c=k.urlToObject(a),h,b=[];for(h in c.query)c.query.hasOwnProperty(h)&&-1===d.indexOf(e,h.toLowerCase())&&b.push(h+"\x3d"+c.query[h]);return c.path+(b.length?"?"+b.join("\x26"):"")},_getPopupGraphic:function(a,e){var c=this.visibleLayers;if(!c||0===c.length)return null;var h=this._popupGraphic;h||(h=new C({title:this.title||"",description:'\x3cdiv style\x3d"position:relative;padding-bottom:56.25%;height:0;overflow:hidden;max-width:100%;"\x3e\x3ciframe src\x3d"{QUERY_URL}" width\x3d"250" height\x3d"147" frameborder\x3d"0" marginwidth\x3d"0" marginheight\x3d"0" style\x3d"position:absolute;top:0;left:0;width:100%;height:100%;border:0;background:url(\''+
n.toUrl("../dijit/images/loading-throb.gif")+"') transparent center no-repeat;\" onload\x3d\"(event.target || event.srcElement).style.background \x3d 'none';\"\x3e\x3c/iframe\x3e\x3c/div\x3e"}),h=this._popupGraphic=new q(null,null,{},h),h._layer=this);var b=function(a){var c=[];if(a&&(a.queryable&&a.showPopup&&a.name&&c.push(a.name),a.subLayers))for(var d=0;d<a.subLayers.length;d++){var e=b(a.subLayers[d]);e.length&&(c=c.concat(e))}return c},f=b({subLayers:this.layerInfos}),f=d.filter(f,function(a){return-1<
d.indexOf(c,a)});if(f.length){var k=this.getFeatureInfoURL,l=this._getImageParams(a.extent,a.width,a.height),l=this._mixinCustomLayerParameters(l);l.REQUEST="GetFeatureInfo";l.INFO_FORMAT=this.featureInfoFormat;l.QUERY_LAYERS=f.join();l.FEATURE_COUNT=25;"1.3.0"===this.version?(l.I=Math.round(e.x),l.J=Math.round(e.y)):(l.X=Math.round(e.x),l.Y=Math.round(e.y));var k=k+(-1===k.indexOf("?")?"?":""),m;for(m in l)l.hasOwnProperty(m)&&(k+="?"===k.substring(k.length-1,k.length)?"":"\x26",k+=m+"\x3d"+l[m]);
h.attributes.QUERY_URL=k;return h}return null},_mixinCustomParameters:function(a){if(this.customParameters)for(var c in this.customParameters)a[c]=encodeURIComponent(this.customParameters[c]);return a},_mixinCustomLayerParameters:function(a){if(this.customLayerParameters||this.customParameters){var c=t.clone(this.customParameters||{});t.mixin(c,this.customLayerParameters||{});for(var d in c)"styles"===d.toLowerCase()&&delete a.STYLES,a[d]=encodeURIComponent(c[d])}return a}});a("extend-esri")&&t.setObject("layers.WMSLayer",
m,v);return m});